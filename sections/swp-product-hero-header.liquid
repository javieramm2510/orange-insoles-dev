{% liquid
  assign product = section.settings.product
  assign message = section.settings.message
  assign current_variant = product.selected_or_first_available_variant
  assign featured_image = current_variant.featured_image | default: product.featured_image 
  assign stamp = section.settings.stamp
  assign stamp_url = section.settings.stamp_url
  assign quant = section.settings.quantity
  assign stock = section.settings.stock
%}

<div id="product" class="mb-10 mx-5 dm:max-w-screen-dm dm:mx-auto dm:px-10 ds:mx-9 dl:px-0">

  <div class="flex flex-col gap-6 ds:flex-row ds:gap-8">
    <div class="ds:sticky ds:top-44 ds:h-max ds:pr-3 ds:w-1/2">

      <div class="swiper swiper1 bg-white shadow-sp rounded-cl w-full mb-6">
        <div class="swiper-wrapper items-center">

          {% for image in product.images %}
            <picture class="swiper-slide swiper-lazy">
                <source media="(min-width: 1024px)" srcset="{{ image | image_url: width: 550 }}">
                <source media="(min-width: 768px)" srcset="{{ image | image_url: width: 990 }}">
                <source media="(min-width: 480px)" srcset="{{ image | image_url: width: 730 }}">
                <img class="w-full max-h-[500px] tl:max-h-[700px] ds:max-h-[600px]" src="{{ image | image_url: width: 440 }}" alt="{{ image.alt | escape  }}" title="{{ product.alt | escape }}" id="ProductPhotoImg">
            </picture>
          {% endfor %}    

        </div>
        <div class="swiper-pagination swiper-pagination-bullets swiper-pagination-horizontal">
          {% for image in product.images %}
            <span class="swiper-pagination-bullet"></span>
          {% endfor %}
        </div>              
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
      </div>

      <div class="swiper swiper2 h-24">
        <div class="swiper-wrapper">
        {% for image in product.images %}
          <div class="swiper-slide flex items-center bg-white rounded-cl" >
            <img class="shadow-sp rounded-cl object-cover mx-auto h-24" src="{{ image | image_url: height: 100 }}" title="{{ product.title | escape }}" alt="{{ image.alt | escape }}">
          </div>
        {% endfor %}
        </div>
      </div>
    </div>

    <div class="ds:w-1/2">
      <div class="flex justify-between items-center mb-[16px]">
        <h1 class="font-bold text-[30px] ts:text-[45px] ds:text-[60px]">{{ product.title }}</h1>
        <h2 class="font-medium text-[15px] text-[#606060] ts:text-[22px] ds:text-[30px]">{{ product.price | money }}</h2>
      </div>
      <div class="text-[20px] text-[#3A3A3A] mb-[24px]">{{ product.description }}</div>
      <div class="text-[18px] bg-[#E68A3F] opacity-80 px-[16px] py-[20px]">{{ message }}</div>
      <div></div>

      
      {% comment %} {% if product.tags contains 'sold out'  %}
        {% form 'contact' %}
          {{ form.errors | default_errors }}
          <div class="flex flex-col gap-4">
            <div>{{ stock }}</div>
            <input type="text" name="contact[name]" id="name" placeholder="Name" class="border-[0.5px] border-secondary rounded-full px-4 py-2" required="required">
            <input type="email" name="contact[email]" id="email" placeholder="Email Address" class="border-[0.5px] border-secondary rounded-full px-4 py-2" required="required">
            <input type="tel" name="contact[phone]" id="phone" placeholder="Phone Number (Optional)" class="border-[0.5px] border-secondary rounded-full px-4 py-2">
            <textarea name="contact[body]" id="message" rows="2" placeholder="Your Message" class="border-[0.5px] border-secondary rounded-cl px-4 py-2"></textarea>
            <input type="submit" value="SUBMIT" class="button cursor-pointer">
          </div>
        {% endform %}
      {% else %}
        {% form 'product', product %}
          <div>
            <div class="flex flex-col pb-4">
              <template v-for="(option, index) in form.options" :key="index">
                <label :for="option.name">${ option.name }:</label>
                <div>
                  <select v-model="selected[index]" @change="form.selections = selected, changePrice()" class="appearance-none border rounded-full border-primary focus:border-secondary focus:outline-none py-1 pl-4 pr-10" :name="option.name" title="Size Selector">
                      <option disabled value="">Please select one</option>
                      <template v-for="(value, i) in option.values">
                      <option :value="value">${ value }</option>
                      </template>
                  </select>
                </div>
              </template>
            </div>
            <div class="hidden flex-col pb-4 product_select">
              <select name="id" id="productSelect" class="variant-selection__variants appearance-none border rounded-full border-primary focus:border-secondary focus:outline-none py-1 pl-4 pr-10">
                {% for variant in product.variants %}
                    <option v-if="variantID == '{{ variant.id }}'" value="{{ variant.id }}">
                      {{ variant.title }} - {{ variant.price | money_with_currency }} - ${ variantID }
                    </option>
                {% endfor %}
              </select>
            </div>

            {% if quant %}
            <div class="flex flex-col mb-6">
              <label for="quantity">Quantity:</label>
              <div class="relative w-1/2 mm:w-1/4 ml:w-1/5 ts:w-1/3 ds:w-1/4">
                  <button @click="decrement" class="flex items-center absolute inset-y-0 left-0 pl-4" type="button" title="quantity minus">-</button>
                  <input v-model.number="qty" class="text-center appearance-none border rounded-full border-primary focus:border-secondary focus:outline-none w-full py-1 px-8" type="number" name="quantity" min="1" title="quantity input">
                  <button @click="increment" class="flex items-center absolute inset-y-0 right-0 pr-4" type="button" title="quantity plus">+</button>
              </div>
            </div>
            {% endif %}
          <div class="flex flex-col gap-4 mm:flex-row">
            <template v-if="variantAvailable == true">
              <button @click="addToCart" class="addToCartBtn button w-full" title="add to cart">
              <template v-if="addingToCart == false">
              ADD TO CART
              </template>
              <template v-else>
                  <div class="animate-spin rounded-full border-[6px] border-t-primary border-b-secondary border-x-secondary h-8 w-8"></div>
              </template>
              </button>
            </template>
            <template v-else>
              <div class="button-disabled w-full" title="add to cart">
                  SOLD OUT
              </div>
            </template>
          </div>
          </div>
        {% endform %}
      {% endif %} {% endcomment %}
    </div>
  </div>
</div>


<script>
//Product gallery slider

//Thumbs images
const swiper2 = new Swiper('.swiper2', {
    slidesPerView: 3,
    spaceBetween: 12,
    breakpoints: {
      1024: {
        slidesPerView: 4,
        spaceBetween: 20
      },
      480: {
        slidesPerView: 5,
      },
    }     
});

//Main gallery
const swiper = new Swiper('.swiper1', {
  loop: true,
  pagination: {
    el: ".swiper-pagination",
  },  
  navigation: {
    nextEl: '.swiper-button-next',
    prevEl: '.swiper-button-prev',
  },
  thumbs: {
    swiper: swiper2,
  },
});
</script>


{% schema %}
{   
  "name": "Product Hero",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "text",
      "id": "message",
      "label": "Quiz CTA"
    },
    {
      "type": "image_picker",
      "id": "desk_banner",
      "label": "Desktop banner image (in case of no metafield image)"
    },
    {
      "type": "image_picker",
      "id": "mob_banner",
      "label": "Mobile banner image (in case of no metafield image)"
    },
    {
      "type": "image_picker",
      "id": "stamp",
      "label": "Stamp"
    },
    {
      "type": "url",
      "id": "stamp_url",
      "label": "Stamp link"
    },
    {
      "type": "checkbox",
      "id": "quantity",
      "label": "Show Quantity selector",
      "default": false
    },
    {
      "type": "textarea",
      "id": "stock",
      "label": "Out of stock message",
      "default": "Not available at this time. This product will be available soon. Please contact us if you would still like to place an order."
    }
    ],
    "presets": [
        {
        "name": "Product Hero"
        }
    ]
}
{% endschema %}